---
import BaseLayout from "@layouts/BaseLayout.astro";
import { getCollection, render } from "astro:content";

const musicians = await getCollection("musicians");
const published = musicians.filter((m) => !m.data.draft).sort((a, b) => (a.id > b.id ? 1 : -1));
---

<BaseLayout title="Musicians" description="List of musicians and short bios">
	<section class="mx-auto max-w-3xl px-4 pt-24 md:mt-24">
		<h1 class="h1 description text-center">Musicians</h1>

		{published.length === 0 && <p class="text-center">No musicians found.</p>}

		{
			published.map(async (m, i) => {
				const isOdd = i % 2 === 1;
				const { Content } = await render(m);
				return (
					<article class="py-10">
						<div
							class={`grid items-center gap-6 md:grid-cols-2 ${isOdd ? "md:flex-row-reverse" : ""}`}
						>
							<div class="flex justify-center">
								<img
									src={`/musicians/${m.data.image}`}
									alt={m.data.name}
									class="w-full max-w-md rounded shadow"
								/>
							</div>
							<div class="prose max-w-none">
								<h3 class="h3">{m.data.name}</h3>
								<div class="markdown-content">
									<Content />
								</div>
							</div>
						</div>
					</article>
				);
			})
		}
	</section>
</BaseLayout>
